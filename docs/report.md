## 1. Title and Author

- Project Title: Investigating the Efficacy of Language Models in Generating SMILES for Lipids
- Prepared for Fall 2023 UMBC Data Science Master Degree Capstone by Dr Chaojie (Jay) Wang
- Author Name: Ben Chen
- Link to the author's GitHub profile: https://github.com/geethurb
- Presentation slides: https://github.com/DATA-606-2023-FALL-MONDAY/Chen_Ben/blob/main/docs/DATA%20606%20Final%20Presentation.pptx

## 2. Background

Lipids are fundamental molecules that play critical roles in various biological processes, including serving as the backbone for lipid nanoparticles used in mRNA vaccine development. The efficient and innovative creation of lipid compounds is paramount for advancing research and applications in this domain. With the rise of artificial intelligence and natural language processing, language models have demonstrated remarkable capabilities in various tasks. This project seeks to leverage these models to generate SMILES (Simplified Molecular Input Line Entry System) for lipids, potentially accelerating research and diversifying lipid compound options beyond traditional methods.

- **What is it about?** 
  - The project aims to investigate the capability of language models to generate accurate and diverse SMILES representations for lipid compounds.
  
- **Why does it matter?** 
  - Efficient lipid compound creation is vital for the development of lipid nanoparticles, crucial for mRNA vaccine delivery. A successful model can expedite research in this area and provide a broader range of lipid options than typically formulated by chemists.
  
- **What are your research questions?**
  - Can language models effectively generate accurate SMILES for lipid compounds?
  - What is the diversity and novelty of the lipid SMILES generated by the models?

## 3. Data 

This project will utilize the LIPID MAPS® Structure Database (LMSD), a comprehensive relational database that contains structures and annotations of biologically relevant lipids. The dataset provides a vast collection of unique lipid structures, making it the world's largest public lipid-only database.

- **Data sources**: 
  - The LIPID MAPS® Structure Database (LMSD)
  
- **Data size**: 
  - Approximately 0.73 MB
  
- **Data shape**: 
  - 47635 rows and 2 columns
  
- **What does each row represent?** 
  - Each row represents a unique lipid structure.
  
- **Data dictionary**:
  - **name**: Identifier or name of the lipid.
  - **smiles**: SMILES representation of the lipid.
  
- **Which variable/column will be your target/label in your ML model?**
  - The target/label will be the `smiles` column.
  
- **Which variables/columns may be selected as features/predictors for your ML models?**
  - The feature will also be the `smiles` columns. The model will try to predict the next character in the string.

## 4. Exploratory Data Analysis (EDA)

- **Handling Missing Values**: 
  - Upon initial inspection of the dataset, a few instances of missing values were identified. A decision was made to omit these records from the dataset to maintain the integrity and quality of the analysis, ensuring that no computations were influenced by unknown or unrecorded data.
 
- **Removing Duplicates**:
  - Duplicate entries, which can introduce bias or inaccuracies in the analysis and model training, were identified and subsequently removed from the dataset. This ensures that each entry contributes a unique piece of information to the analysis and model training.

- **SMILES String Canonicalization and Validation**:
  - The lipid SMILES strings underwent a process of canonicalization, ensuring a standardized representation of the molecular structures. Following this, a validation check was conducted to confirm the viability and accuracy of the SMILES strings. Instances containing invalid SMILES were identified and omitted from the dataset, ensuring that only accurate and reliable data was utilized in subsequent analyses and model training.

- **Character Encoding**:
  - To facilitate the computational handling and analysis of the SMILES strings, each unique character within the strings was mapped to a unique integer through a process of character encoding. This transformation allows for the effective utilization of SMILES string data in machine learning models, ensuring that the models can interpret and learn from the structural information contained within the strings.

- **Training and Testing Split**:
  - The dataset was divided into training and testing subsets, adhering to a 90/10 split, respectively. This approach ensures that the models are trained on a substantial portion of the data, while also reserving a distinct subset of the data for evaluating the model's predictive performance and generalization capabilities.

## 5. Model
- **Generative Pretrained Transformer (GPT)**:
  - A powerful model for text generation, adept at learning complex patterns.
- **Simplified Molecular-Input Line-Entry System (SMILES)**:
  - A method to represent molecules with strings, widely used in chemistry.
- **nanoGPT**:
  - A small GPT model from https://github.com/karpathy/nanoGPT, balancing efficiency and learning capability.
- **Generation Process**:
  - The model predicts subsequent tokens sequentially, constructing the SMILES string until a stop token is reached, indicating the completion of a molecule.

